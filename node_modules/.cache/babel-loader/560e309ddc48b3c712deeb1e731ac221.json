{"ast":null,"code":"import { get, post } from '@/utils/request';\nimport { ElMessage } from 'element-plus';\nexport default {\n  data() {\n    return {\n      activeName: '内科',\n      finished: false,\n      showAdd: false,\n      dayList: [],\n      base: '',\n      today: '',\n      nextMonday: '',\n      lastsunday: '',\n      role: false,\n      dialogVisible: false,\n      planstatus: {},\n      curplanday: '',\n      departments: [],\n      doctors: [],\n      fees: []\n    };\n  },\n\n  mounted() {\n    this.getTime();\n    this.getFees();\n  },\n\n  methods: {\n    getLabel(value) {\n      console.log(value);\n      let obj = {};\n      obj = this.options.find(item => {\n        return item.value === value;\n      });\n      console.log(obj.label);\n    },\n\n    getFees() {\n      get('/getDoctorFees').then(res => {\n        this.fees = res.data;\n      });\n    },\n\n    check(doctorworks) {\n      let amworks = [];\n      let pmworks = [];\n\n      for (var i = 0; i < doctorworks.length; i++) {\n        amworks.push(doctorworks[i].amwork);\n        pmworks.push(doctorworks[i].pmwork);\n      }\n\n      amworks = amworks.sort();\n      pmworks = pmworks.sort();\n\n      for (var i = 0; i < amworks.length - 1; i++) {\n        if (amworks[i] == amworks[i + 1] && amworks[i] != '0') {\n          alert('上午排班地点有冲突');\n          return false;\n        }\n      }\n\n      for (var i = 0; i < pmworks.length - 1; i++) {\n        if (pmworks[i] == pmworks[i + 1] && pmworks[i] != '0') {\n          alert('下午排班地点有冲突');\n          return false;\n        }\n      }\n\n      return true;\n    },\n\n    savePlan(departmentId) {\n      var formData = new FormData();\n      formData.append('day', this.curplanday);\n      formData.append('departmentId', departmentId);\n      let doctorworks = [];\n\n      if (this.doctors.length > 0) {\n        for (var i = 0; i < this.doctors.length; i++) {\n          if (departmentId == this.doctors[i].departId1) {\n            formData.append('doctorworks[' + i + '].docId', this.doctors[i].docId);\n            formData.append('doctorworks[' + i + '].departId1', this.doctors[i].departId1);\n            formData.append('doctorworks[' + i + '].amwork', this.doctors[i].amwork);\n            formData.append('doctorworks[' + i + '].pmwork', this.doctors[i].pmwork);\n            formData.append('doctorworks[' + i + '].feeId', this.doctors[i].feeId);\n            doctorworks.push(this.doctors[i]);\n          }\n        }\n\n        if (!this.check(doctorworks)) return;\n        post('/updateDoctorWorks', formData).then(res => {\n          alert('更新成功');\n          this.reload();\n        }).catch(error => {\n          console.log(error);\n        });\n      }\n    },\n\n    getDoctors(day) {\n      get('/getDoctorWorks', {\n        day: day\n      }).then(res => {\n        this.doctors = res.data;\n        console.log(); //   for (var i = 0; i < res.data.data.length + 1; i++) {\n        //     this.doctors[i].rooms = res.data.data[i].rooms;\n        //   }\n\n        for (var i = 0; i < res.data.length + 1; i++) {\n          this.doctors[i].rooms = res.data[i].rooms;\n        }\n\n        console.log(\"=================================\");\n        console.log(this.doctors);\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    submitStatus() {\n      get('/updatePlanStatus', {\n        day: this.curplanday,\n        status: this.finished ? 1 : 0\n      }).then(res => {\n        ElMessage({\n          message: '状态修改成功',\n          type: 'success'\n        });\n        this.$router.go(0);\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    addPlan(index) {\n      this.showAdd = true;\n      this.finished = false;\n      this.curplanday = this.dayList[index - 1];\n      this.getDepartments();\n      this.getDoctors(this.curplanday);\n    },\n\n    editPlan(index) {\n      this.showAdd = true;\n      this.finished = true;\n      this.curplanday = this.dayList[index - 1];\n      this.getDepartments();\n      this.getDoctors(this.curplanday);\n    },\n\n    startplan() {\n      get('/generatePlans', {\n        startDay: this.nextMonday\n      }).then(res => {\n        ElMessage({\n          message: '生成排班成功',\n          type: 'success'\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    getDepartments() {\n      get('/getDepartsLevel1').then(res => {\n        console.log(res);\n        this.departments = res.data;\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    lastweek() {\n      this.showAdd = false;\n      this.dayList = [];\n      this.getBeforNday(this.base, 7);\n      this.getTableData(this.nextMonday);\n    },\n\n    nextweek() {\n      this.showAdd = false;\n      this.dayList = [];\n      this.getBeforNday(this.base, -7);\n      this.getTableData(this.nextMonday);\n    },\n\n    getTime() {\n      var myDate = new Date();\n      var str = myDate.getDay();\n      console.log(str, 888);\n\n      for (var i = 0; i < 7; i++) if (str == i) {\n        this.getBeforNday(myDate, str);\n      }\n    },\n\n    getBeforNday(date, n) {\n      var todays = date.getTime();\n      var today = new Date();\n      this.today = today.setTime(todays);\n      var yesterday_milliseconds = date.getTime() - n * 1000 * 60 * 60 * 24;\n      var yesterday = new Date();\n      yesterday.setTime(yesterday_milliseconds);\n      var strYear = yesterday.getFullYear();\n      var strDay = yesterday.getDate();\n      var strMonth = yesterday.getMonth() + 1;\n\n      if (strMonth < 10) {\n        strMonth = '0' + strMonth;\n      }\n\n      let datastr = strYear + '年' + strMonth + '月' + strDay + '日';\n      let md = strMonth + '-' + strDay;\n      this.sunday = md;\n      this.lastsunday = datastr;\n      this.dateFormat1 = strYear + '-' + strMonth + '-' + strDay;\n      this.base = yesterday;\n\n      for (var i = -1; i > -8; i--) this.getotherday(yesterday, i);\n    },\n\n    getotherday(date, n) {\n      var yesterday_milliseconds = date.getTime() - n * 1000 * 60 * 60 * 24;\n      var yesterday = new Date();\n      yesterday.setTime(yesterday_milliseconds);\n      var strYear = yesterday.getFullYear();\n      var strDay = yesterday.getDate();\n      var strMonth = yesterday.getMonth() + 1;\n\n      if (strMonth < 10) {\n        strMonth = '0' + strMonth;\n      }\n\n      if (strDay < 10) {\n        strDay = '0' + strDay;\n      }\n\n      if (n == -1) {\n        this.monday = strMonth + '.' + strDay;\n        this.monday1 = '星期一' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')';\n        this.nextMonday = strYear + '-' + strMonth + '-' + strDay;\n        this.getTableData(this.nextMonday);\n        this.dateFormat2 = strYear + '-' + strMonth + '-' + strDay;\n        this.dayList.push(this.dateFormat2);\n      }\n\n      if (n == -2) {\n        this.tuesday = strMonth + '.' + strDay;\n        this.tuesday1 = '星期二' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')';\n        this.dateFormat3 = strYear + '-' + strMonth + '-' + strDay;\n        this.dayList.push(this.dateFormat3);\n      }\n\n      if (n == -3) {\n        this.wednesday = strMonth + '.' + strDay;\n        this.wednesday1 = '星期三' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')';\n        this.dateFormat4 = strYear + '-' + strMonth + '-' + strDay;\n        this.dayList.push(this.dateFormat4);\n      }\n\n      if (n == -4) {\n        this.thursday = strMonth + '.' + strDay;\n        this.thursday1 = '星期四' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')';\n        this.dateFormat5 = strYear + '-' + strMonth + '-' + strDay;\n        this.dayList.push(this.dateFormat5);\n      }\n\n      if (n == -5) {\n        this.friday = strMonth + '.' + strDay;\n        this.friday1 = '星期五' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')';\n        this.dateFormat6 = strYear + '-' + strMonth + '-' + strDay;\n        this.dayList.push(this.dateFormat6);\n      }\n\n      if (n == -6) {\n        this.saturday = strMonth + '.' + strDay;\n        this.saturday1 = '星期六' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')';\n        this.dateFormat7 = strYear + '-' + strMonth + '-' + strDay;\n        this.dayList.push(this.dateFormat7);\n      }\n\n      if (n == -7) {\n        this.sunday = strMonth + '.' + strDay;\n        this.sunday1 = '星期天' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')';\n        this.lastsunday = strYear + '年' + strMonth + '月' + strDay + '日';\n        this.dateFormat8 = strYear + '-' + strMonth + '-' + strDay;\n        this.dayList.push(this.dateFormat8);\n      }\n    },\n\n    getTableData(day) {\n      get('/getPlansStatus', {\n        startDay: day\n      }).then(res => {\n        console.log(res.data);\n        this.planstatus = res.data;\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    handleSelectionChange(val) {\n      this.checkedList = val;\n    },\n\n    handleCurrentChange(newPage) {\n      this.queryInfo.pagenum = newPage;\n      this.getTableList(this.nextMonday);\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["get","post","ElMessage","data","activeName","finished","showAdd","dayList","base","today","nextMonday","lastsunday","role","dialogVisible","planstatus","curplanday","departments","doctors","fees","mounted","getTime","getFees","methods","getLabel","value","console","log","obj","options","find","item","label","then","res","check","doctorworks","amworks","pmworks","i","length","push","amwork","pmwork","sort","alert","savePlan","departmentId","formData","FormData","append","departId1","docId","feeId","reload","catch","error","getDoctors","day","rooms","submitStatus","status","message","type","$router","go","addPlan","index","getDepartments","editPlan","startplan","startDay","lastweek","getBeforNday","getTableData","nextweek","myDate","Date","str","getDay","date","n","todays","setTime","yesterday_milliseconds","yesterday","strYear","getFullYear","strDay","getDate","strMonth","getMonth","datastr","md","sunday","dateFormat1","getotherday","monday","monday1","dateFormat2","tuesday","tuesday1","dateFormat3","wednesday","wednesday1","dateFormat4","thursday","thursday1","dateFormat5","friday","friday1","dateFormat6","saturday","saturday1","dateFormat7","sunday1","dateFormat8","handleSelectionChange","val","checkedList","handleCurrentChange","newPage","queryInfo","pagenum","getTableList"],"sourceRoot":"","sources":["D:\\小学期vscode\\demo01\\src\\views\\WorkPlan\\index.vue"],"sourcesContent":["<template>\r\n  <div class=\"big\">\r\n    <!-- 列表 -->\r\n    <el-card class=\"box-card\">\r\n      <div class=\"search\">\r\n        <el-button type=\"primary\" @click=\"lastweek\">上一周</el-button>\r\n        <el-button\r\n          type=\"success\"\r\n          @click=\"startplan\"\r\n          >开始排班</el-button\r\n        >\r\n        <el-button type=\"primary\" @click=\"nextweek\">下一周</el-button>\r\n        <div class=\"title\">\r\n          <span>{{ nextMonday }}</span>\r\n          <span>星期一</span>\r\n          <span>~</span>\r\n          <span>{{ lastsunday }}</span>\r\n          <span>星期天</span>\r\n        </div>\r\n      </div>\r\n      <el-divider>\r\n        <el-icon><star-filled /></el-icon>\r\n      </el-divider>\r\n\r\n      <table\r\n        border=\"0\"\r\n        cellspacing=\"1px\"\r\n        bordercolor=\"#254389\"\r\n        cellpadding=\"0\"\r\n        style=\"border-collapse: collapse\"\r\n      >\r\n        <thead>\r\n          <tr height=\"50\">\r\n            <td width=\"180\">{{ monday1 }}</td>\r\n            <td width=\"180\">{{ tuesday1 }}</td>\r\n            <td width=\"180\">{{ wednesday1 }}</td>\r\n            <td width=\"180\">{{ thursday1 }}</td>\r\n            <td width=\"180\">{{ friday1 }}</td>\r\n            <td width=\"180\">{{ saturday1 }}</td>\r\n            <td width=\"180\">{{ sunday1 }}</td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-if=\"planstatus != null && planstatus != {}\">\r\n            <td>\r\n              <el-button\r\n                v-if=\"planstatus.mondayStatus == 0\"\r\n                type=\"success\"\r\n                @click=\"addPlan(1)\"\r\n                >增加</el-button\r\n              >\r\n              <el-button\r\n                v-if=\"planstatus.mondayStatus == 1\"\r\n                type=\"primary\"\r\n                @click=\"editPlan(1)\"\r\n                >查看</el-button\r\n              >\r\n            </td>\r\n            <td>\r\n              <el-button\r\n                v-if=\"planstatus.tuesdayStatus == 0\"\r\n                type=\"success\"\r\n                @click=\"addPlan(2)\"\r\n                >增加</el-button\r\n              >\r\n              <el-button\r\n                v-if=\"planstatus.tuesdayStatus == 1\"\r\n                type=\"primary\"\r\n                @click=\"editPlan(2)\"\r\n                >查看</el-button\r\n              >\r\n            </td>\r\n            <td>\r\n              <el-button\r\n                v-if=\"planstatus.wednesdayStatus == 0\"\r\n                type=\"success\"\r\n                @click=\"addPlan(3)\"\r\n                >增加</el-button\r\n              >\r\n              <el-button\r\n                v-if=\"planstatus.wednesdayStatus == 1\"\r\n                type=\"primary\"\r\n                @click=\"editPlan(3)\"\r\n                >查看</el-button\r\n              >\r\n            </td>\r\n            <td>\r\n              <el-button\r\n                v-if=\"planstatus.thursdayStatus == 0\"\r\n                type=\"success\"\r\n                @click=\"addPlan(4)\"\r\n                >增加</el-button\r\n              >\r\n              <el-button\r\n                v-if=\"planstatus.thursdayStatus == 1\"\r\n                type=\"primary\"\r\n                @click=\"editPlan(4)\"\r\n                >查看</el-button\r\n              >\r\n            </td>\r\n            <td>\r\n              <el-button\r\n                v-if=\"planstatus.fridayStatus == 0\"\r\n                type=\"success\"\r\n                @click=\"addPlan(5)\"\r\n                >增加</el-button\r\n              >\r\n              <el-button\r\n                v-if=\"planstatus.fridayStatus == 1\"\r\n                type=\"primary\"\r\n                @click=\"editPlan(5)\"\r\n                >查看</el-button\r\n              >\r\n            </td>\r\n            <td>\r\n              <el-button\r\n                v-if=\"planstatus.saturdayStatus == 0\"\r\n                type=\"success\"\r\n                @click=\"addPlan(6)\"\r\n                >增加</el-button\r\n              >\r\n              <el-button\r\n                v-if=\"planstatus.saturdayStatus == 1\"\r\n                type=\"primary\"\r\n                @click=\"editPlan(6)\"\r\n                >查看</el-button\r\n              >\r\n            </td>\r\n            <td>\r\n              <el-button\r\n                v-if=\"planstatus.sundayStatus == 0\"\r\n                type=\"success\"\r\n                @click=\"addPlan(7)\"\r\n                >增加</el-button\r\n              >\r\n              <el-button\r\n                v-if=\"planstatus.sundayStatus == 1\"\r\n                type=\"primary\"\r\n                @click=\"editPlan(7)\"\r\n                >查看</el-button\r\n              >\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <el-divider></el-divider>\r\n\r\n      <div v-if=\"showAdd\" class=\"el-card-define\">\r\n        <div align=\"center\">\r\n          <h2>{{ this.curplanday }}排班工作</h2>\r\n          <el-switch\r\n            v-model=\"finished\"\r\n            class=\"ml-2\"\r\n            active-color=\"#13ce66\"\r\n            inactive-color=\"#ff4949\"\r\n            active-text=\"完成\"\r\n            inactive-text=\"未完成\"\r\n            @click=\"submitStatus()\"\r\n          />\r\n        </div>\r\n        <el-tabs\r\n          v-model=\"activeName\"\r\n          class=\"demo-tabs\"\r\n          @tab-click=\"handleClick\"\r\n        >\r\n          <el-tab-pane\r\n            v-for=\"d in departments\"\r\n            :key=\"d.departmentId\"\r\n            :label=\"d.departmentName\"\r\n            :name=\"d.departmentName\"\r\n          >\r\n            <div v-if=\"d.departmentName == activeName\">\r\n              <table align=\"center\">\r\n                <thead>\r\n                  <tr>\r\n                    <td width=\"200\">医生姓名</td>\r\n                    <td width=\"200\">医生职称</td>\r\n                    <td width=\"200\">出诊类型</td>\r\n                    <td width=\"200\">上午</td>\r\n                    <td width=\"200\">下午</td>\r\n                    <td></td>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr v-for=\"doc in doctors\" :key=\"doc.docId\">\r\n                    <td v-if=\"doc.departId1 == d.departmentId\">\r\n                      {{ doc.docName }}\r\n                    </td>\r\n                    <td v-if=\"doc.departId1 == d.departmentId\">\r\n                      {{ doc.docTitle }}\r\n                    </td>\r\n                    <td v-if=\"doc.departId1 == d.departmentId\">\r\n                     <el-select v-model=\"doc.feeId\" placeholder=\"请选择出诊类型\" value-key=\"feeId\" @change=\"getLabel\">\r\n                        <el-option\r\n                          v-for=\"(fee) in fees\"\r\n                          :key=\"fee.feeId\"\r\n                          :label=\"fee.feeName\"\r\n                          :value=\"fee.feeId\"\r\n                        >\r\n                        </el-option>\r\n                      </el-select>\r\n                    </td>\r\n                    <td v-if=\"doc.departId1 == d.departmentId\">\r\n                      <el-select v-model=\"doc.amwork\" placeholder=\"请选择房间\">\r\n                        <el-option label=\"休息\" value=\"0\">休息</el-option>\r\n                        <el-option\r\n                          v-for=\"(room, index) in doc.rooms\"\r\n                          :key=\"index\"\r\n                          :label=\"room.roomName\"\r\n                          :value=\"room.roomName\"\r\n                        >\r\n                        </el-option>\r\n                      </el-select>\r\n                    </td>\r\n                    <td v-if=\"doc.departId1 == d.departmentId\">\r\n                      <el-select v-model=\"doc.pmwork\" placeholder=\"请选择房间\">\r\n                       <el-option label=\"休息\" value=\"0\">休息</el-option>\r\n                        <el-option\r\n                          v-for=\"(room, index) in doc.rooms\"\r\n                          :key=\"index\"\r\n                          :label=\"room.roomName\"\r\n                          :value=\"room.roomName\"\r\n                        >\r\n                        </el-option>\r\n                      </el-select>\r\n                    </td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n              <div align=\"center\" style=\"margin: 30px\">\r\n                <el-button\r\n                  type=\"success\"\r\n                  plain\r\n                  v-show=\"!finished\"\r\n                  @click=\"savePlan(d.departmentId)\"\r\n                  >保存</el-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </el-tab-pane>\r\n        </el-tabs>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { get, post } from '@/utils/request'\r\nimport { ElMessage } from 'element-plus'\r\nexport default {\r\n  data() {\r\n    return {\r\n      activeName: '内科',\r\n      finished: false,\r\n      showAdd: false,\r\n      dayList: [],\r\n      base: '',\r\n      today: '',\r\n      nextMonday: '',\r\n      lastsunday: '',\r\n      role: false,\r\n      dialogVisible: false,\r\n      planstatus: {},\r\n      curplanday: '',\r\n      departments: [],\r\n      doctors: [],\r\n      fees: []\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getTime()\r\n    this.getFees()\r\n  },\r\n  methods: {\r\n    getLabel(value) {\r\n    console.log(value);\r\n      let obj = {};\r\n      obj = this.options.find((item)=>{\r\n          return item.value === value;\r\n      });\r\n      console.log(obj.label);\r\n},\r\n    getFees() {\r\n      get('/getDoctorFees').then((res) => {\r\n        this.fees = res.data\r\n      })\r\n    },\r\n    check(doctorworks) {\r\n      let amworks = []\r\n      let pmworks = []\r\n      for (var i = 0; i < doctorworks.length; i++) {\r\n        amworks.push(doctorworks[i].amwork)\r\n        pmworks.push(doctorworks[i].pmwork)\r\n      }\r\n      amworks = amworks.sort()\r\n      pmworks = pmworks.sort()\r\n      for (var i = 0; i < amworks.length - 1; i++) {\r\n        if (amworks[i] == amworks[i + 1] && amworks[i] != '0') {\r\n          alert('上午排班地点有冲突')\r\n          return false\r\n        }\r\n      }\r\n      for (var i = 0; i < pmworks.length - 1; i++) {\r\n        if (pmworks[i] == pmworks[i + 1] && pmworks[i] != '0') {\r\n          alert('下午排班地点有冲突')\r\n          return false\r\n        }\r\n      }\r\n      return true\r\n    },\r\n    savePlan(departmentId) {\r\n      var formData = new FormData()\r\n      formData.append('day', this.curplanday)\r\n      formData.append('departmentId', departmentId)\r\n      let doctorworks = []\r\n      if (this.doctors.length > 0) {\r\n        for (var i = 0; i < this.doctors.length; i++) {\r\n          if (departmentId == this.doctors[i].departId1) {\r\n            formData.append(\r\n              'doctorworks[' + i + '].docId',\r\n              this.doctors[i].docId\r\n            )\r\n            formData.append(\r\n              'doctorworks[' + i + '].departId1',\r\n              this.doctors[i].departId1\r\n            )\r\n            formData.append(\r\n              'doctorworks[' + i + '].amwork',\r\n              this.doctors[i].amwork\r\n            )\r\n            formData.append(\r\n              'doctorworks[' + i + '].pmwork',\r\n              this.doctors[i].pmwork\r\n            )\r\n            formData.append(\r\n              'doctorworks[' + i + '].feeId',\r\n              this.doctors[i].feeId\r\n            )\r\n            doctorworks.push(this.doctors[i])\r\n          }\r\n        }\r\n      if (!this.check(doctorworks)) return\r\n      post('/updateDoctorWorks', formData)\r\n        .then((res) => {\r\n          alert('更新成功')\r\n          this.reload()\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n      }\r\n    },\r\n\r\n    getDoctors(day) {\r\n      get('/getDoctorWorks', { day: day })\r\n        .then((res) => {\r\n          this.doctors = res.data\r\n          console.log()\r\n        //   for (var i = 0; i < res.data.data.length + 1; i++) {\r\n        //     this.doctors[i].rooms = res.data.data[i].rooms;\r\n        //   }\r\n          for (var i = 0; i < res.data.length + 1; i++) {\r\n            this.doctors[i].rooms = res.data[i].rooms;\r\n          }\r\n        console.log(\"=================================\")\r\n          console.log(this.doctors)\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n    },\r\n\r\n    submitStatus() {\r\n      get('/updatePlanStatus', {\r\n        day: this.curplanday,\r\n        status: this.finished ? 1 : 0\r\n      })\r\n        .then((res) => {\r\n          ElMessage({\r\n            message: '状态修改成功',\r\n            type: 'success'\r\n          })\r\n          this.$router.go(0)\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n    },\r\n\r\n    addPlan(index) {\r\n      this.showAdd = true\r\n      this.finished = false\r\n      this.curplanday = this.dayList[index - 1]\r\n      this.getDepartments()\r\n      this.getDoctors(this.curplanday)\r\n    },\r\n\r\n    editPlan(index) {\r\n      this.showAdd = true\r\n      this.finished = true\r\n      this.curplanday = this.dayList[index - 1]\r\n      this.getDepartments()\r\n      this.getDoctors(this.curplanday)\r\n    },\r\n\r\n    startplan() {\r\n      get('/generatePlans', { startDay: this.nextMonday })\r\n        .then((res) => {\r\n          ElMessage({\r\n            message: '生成排班成功',\r\n            type: 'success'\r\n          })\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n    },\r\n    getDepartments() {\r\n      get('/getDepartsLevel1')\r\n        .then((res) => {\r\n          console.log(res)\r\n          this.departments = res.data\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n    },\r\n    lastweek() {\r\n      this.showAdd = false\r\n      this.dayList = []\r\n      this.getBeforNday(this.base, 7)\r\n      this.getTableData(this.nextMonday)\r\n    },\r\n    nextweek() {\r\n      this.showAdd = false\r\n      this.dayList = []\r\n      this.getBeforNday(this.base, -7)\r\n      this.getTableData(this.nextMonday)\r\n    },\r\n    getTime() {\r\n      var myDate = new Date()\r\n      var str = myDate.getDay()\r\n      console.log(str, 888)\r\n      for (var i = 0; i < 7; i++)\r\n        if (str == i) {\r\n          this.getBeforNday(myDate, str)\r\n        }\r\n    },\r\n    getBeforNday(date, n) {\r\n      var todays = date.getTime()\r\n      var today = new Date()\r\n      this.today = today.setTime(todays)\r\n\r\n      var yesterday_milliseconds = date.getTime() - n * 1000 * 60 * 60 * 24\r\n      var yesterday = new Date()\r\n\r\n      yesterday.setTime(yesterday_milliseconds)\r\n\r\n      var strYear = yesterday.getFullYear()\r\n      var strDay = yesterday.getDate()\r\n      var strMonth = yesterday.getMonth() + 1\r\n      if (strMonth < 10) {\r\n        strMonth = '0' + strMonth\r\n      }\r\n      let datastr = strYear + '年' + strMonth + '月' + strDay + '日'\r\n      let md = strMonth + '-' + strDay\r\n      this.sunday = md\r\n      this.lastsunday = datastr\r\n      this.dateFormat1 = strYear + '-' + strMonth + '-' + strDay\r\n      this.base = yesterday\r\n      for (var i = -1; i > -8; i--) this.getotherday(yesterday, i)\r\n    },\r\n    getotherday(date, n) {\r\n      var yesterday_milliseconds = date.getTime() - n * 1000 * 60 * 60 * 24\r\n      var yesterday = new Date()\r\n      yesterday.setTime(yesterday_milliseconds)\r\n\r\n      var strYear = yesterday.getFullYear()\r\n      var strDay = yesterday.getDate()\r\n      var strMonth = yesterday.getMonth() + 1\r\n      if (strMonth < 10) {\r\n        strMonth = '0' + strMonth\r\n      }\r\n      if (strDay < 10) {\r\n        strDay = '0' + strDay\r\n      }\r\n      if (n == -1) {\r\n        this.monday = strMonth + '.' + strDay\r\n        this.monday1 =\r\n          '星期一' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')'\r\n        this.nextMonday = strYear + '-' + strMonth + '-' + strDay\r\n        this.getTableData(this.nextMonday)\r\n        this.dateFormat2 = strYear + '-' + strMonth + '-' + strDay\r\n        this.dayList.push(this.dateFormat2)\r\n      }\r\n      if (n == -2) {\r\n        this.tuesday = strMonth + '.' + strDay\r\n        this.tuesday1 =\r\n          '星期二' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')'\r\n        this.dateFormat3 = strYear + '-' + strMonth + '-' + strDay\r\n        this.dayList.push(this.dateFormat3)\r\n      }\r\n      if (n == -3) {\r\n        this.wednesday = strMonth + '.' + strDay\r\n        this.wednesday1 =\r\n          '星期三' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')'\r\n        this.dateFormat4 = strYear + '-' + strMonth + '-' + strDay\r\n        this.dayList.push(this.dateFormat4)\r\n      }\r\n      if (n == -4) {\r\n        this.thursday = strMonth + '.' + strDay\r\n        this.thursday1 =\r\n          '星期四' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')'\r\n        this.dateFormat5 = strYear + '-' + strMonth + '-' + strDay\r\n        this.dayList.push(this.dateFormat5)\r\n      }\r\n      if (n == -5) {\r\n        this.friday = strMonth + '.' + strDay\r\n        this.friday1 =\r\n          '星期五' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')'\r\n        this.dateFormat6 = strYear + '-' + strMonth + '-' + strDay\r\n        this.dayList.push(this.dateFormat6)\r\n      }\r\n      if (n == -6) {\r\n        this.saturday = strMonth + '.' + strDay\r\n        this.saturday1 =\r\n          '星期六' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')'\r\n        this.dateFormat7 = strYear + '-' + strMonth + '-' + strDay\r\n        this.dayList.push(this.dateFormat7)\r\n      }\r\n      if (n == -7) {\r\n        this.sunday = strMonth + '.' + strDay\r\n        this.sunday1 =\r\n          '星期天' + '(' + strYear + ' / ' + strMonth + ' / ' + strDay + ')'\r\n        this.lastsunday = strYear + '年' + strMonth + '月' + strDay + '日'\r\n        this.dateFormat8 = strYear + '-' + strMonth + '-' + strDay\r\n        this.dayList.push(this.dateFormat8)\r\n      }\r\n    },\r\n\r\n    getTableData(day) {\r\n      get('/getPlansStatus', { startDay: day })\r\n        .then((res) => {\r\n          console.log(res.data)\r\n          this.planstatus = res.data\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.checkedList = val\r\n    },\r\n    handleCurrentChange(newPage) {\r\n      this.queryInfo.pagenum = newPage\r\n      this.getTableList(this.nextMonday)\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.title {\r\n  color: var(--el-text-color-regular);\r\n  font-size: 24px;\r\n  margin: 10px 0;\r\n  text-align: center;\r\n  color: #409eff;\r\n}\r\n.box-card {\r\n}\r\n.box-card1 {\r\n  margin-top: 5px;\r\n}\r\n.el-card-define {\r\n  height: 350px;\r\n  overflow-y: auto;\r\n}\r\n.big {\r\n  margin-top: 10px;\r\n  margin-left: 15px;\r\n  margin-right: 15px;\r\n}\r\n.ml-2 {\r\n  margin: 10px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}